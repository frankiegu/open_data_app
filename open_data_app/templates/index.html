<!DOCTYPE html>
<html>
<head>
    <title>公开数据集应用平台</title>
    <link rel="stylesheet" type="text/css" href='{{url_for("static",filename="semantic.min.css")}}'>
    <script type="text/javascript" src='{{url_for("static",filename="jquery-3.2.1.js")}}'></script>
    <script type="text/javascript" src='{{url_for("static",filename="semantic.min.js")}}'></script>
    <style type="text/css">

        .result {
            display: none;

        }

        #myclass .model {
            display: none;
        }

        #myclass .model.active{
            display: block;
        }
        .active {
            display: inline-block;
        }

        .basic_form {
            position: relative;
        }


/*
        .basic_form button {
            position: absolute;
            right: 1px;
        }*/
    </style>
</head>
<body id="myclass">
<div class="ui brown inverted segment">
    <h1>公开数据集应用平台</h1>
    <small>一个希望让公开数据集获得真正的幸福的网站</small>
</div>
<div class="ui secondary pointing menu">
  <!-- <a class="item active">Home</a> -->
  {% for model in models %}
    <a class="item" name="{{model['baseinfo']['name']}}">{{model['baseinfo']['name_cn']}}</a>
  {% endfor %}
</div>

{% for model in models %}
<div class="ui grid model" id="{{model['baseinfo']['name']}}">
    <div class="six wide column">
        <div class="ui segment" >
            <h2>{{model['baseinfo']['name_cn']}}</h2>
            <p>请填入新的花样数据</p>
            <div class="ui form basic_form">
            
                {% for feature in model['features'] %}
                <div class="field">
                    <label>{{ model['features'][feature]['describe'] }}</label>
                    <input type="number" name="{{feature}}" value="6.1" class="ui input">
                </div>
                {% endfor %}

                <button class="ui button predict">预测一下</button>
            </div>
        </div>
    </div>
    <div class="ui eight wide column result">
        <label>预测结果为：</label>
        <p></p>
    </div>
</div>
{% endfor %}

<script type="text/javascript">
    $(".predict").click(function(){
        var formdata = {'data':[]}
        var model_area = $(this).parents('#iris')
        var id = model_area.attr('id')
        model_area.find('input').each(function(){
            formdata['data'].push($(this).val())
        });
        console.info(formdata);
        $.ajax({
            url: "/api/predict/"+id,
            data:JSON.stringify(formdata),
            type: "POST",
            contentType : "application/json; charset=utf-8",
            datatype:"json",
        }).done(function(json){
            model_area.find('.result p').text(json[0])
            model_area.find('.result').addClass('active');
            }
        )
    });
    $( document ).ready(function(){
        $(".menu .item").first().addClass('active');
        $(".model").first().addClass('active');
    })
    $(".menu .item").click(function(){
        $(".menu .item").removeClass('active');
        $(this).addClass('active');
        $(".model").removeClass('active');
        var id = $(this).attr('name')
        $('#'+id).addClass('active');
    })
</script>
</body>
</html>